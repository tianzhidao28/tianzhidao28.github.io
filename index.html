<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="rocyuan" />

<meta name="keywords" content="rocyuan,袁,Java编程,Spring Struts,Webwork框架深入,XMLHTTP Ajax开发,Java,Web开发,Java企业应用,Java设计模式,Java开源框架,Java应用服务器,Rich Client讨论,Ruby编程">

<meta name="description" content="rocyuan blog 是一个为哲学而生的博客，一切是为了艺术">


    
     
        <meta name="google-site-verification" content="VmInQfXsW7YHb75k4VWsFYgfCr16D-Lgh-yjUv1ofdc" />
    

     

<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="rocyuan">
<meta property="og:url" content="http://www.rocyuan.com/index.html">
<meta property="og:site_name" content="rocyuan">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rocyuan">
<meta name="twitter:description">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternative" href="/atom.xml" title="rocyuan" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>rocyuan</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>





    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?c45a2b4d39ba289213f1de03ad45168d";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>


</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">rocyuan</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:admin@rocyuan.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/api/">api</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpc/">rpc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/service/">service</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/soa/">soa</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">黑暗中的引路人</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">rocyuan</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">rocyuan</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:admin@rocyuan.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="#" title="GitHub"></a>
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-Java-ClassLoader加载机制与SOA优化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/Java-ClassLoader加载机制与SOA优化/" class="article-date">
      <time datetime="2016-06-26T12:56:54.000Z" itemprop="datePublished">2016-06-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/Java-ClassLoader加载机制与SOA优化/">Java ClassLoader加载机制与SOA优化</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Java-ClassLoader-类加载-与-SOA后期优化"><a href="#Java-ClassLoader-类加载-与-SOA后期优化" class="headerlink" title="Java ClassLoader 类加载 与 SOA后期优化"></a>Java ClassLoader 类加载 与 SOA后期优化</h1><h2 id="现在见到的一些应用部署方式-我见到的"><a href="#现在见到的一些应用部署方式-我见到的" class="headerlink" title="现在见到的一些应用部署方式(我见到的)"></a>现在见到的一些应用部署方式(我见到的)</h2><p><code>只能说是我见到的这2种</code></p><ul><li>1 . mvn clean package 打成war 再丢到web容器</li><li>2 . mvn clean package 打成jar 直接运行(<code>这是我这一年才见到的这么粗暴的方式</code>),但也简单干脆,<br>最近看jetty 官网也逐渐感觉或许这是个不错的单应用选择吧</li></ul><p><img src="http://7xogqz.com1.z0.glb.clouddn.com/jetty_office.png" alt="jetty官网"></p><blockquote><p>Don’t deploy your application in Jetty, deploy Jetty in your application!</p></blockquote><p><code>use jetty as a http module,not a web container just a module of your application</code></p><hr><p>在一个大的系统砸碎成一片片的服务的后期,就会产生一大波妹子了, 不 , 一大波的服务s,<br>一般一个服务(以 java 为例)的组成是:</p><ul><li><code>一些公共jar</code>: spring-<strong>.jar , common-*.jar , db</strong>jar,cache**.jar <code>一般有个 大于 10M</code></li><li>一些公共rpc jar : eg:dubbo**.jar 或其他的jar</li><li>业务相关jar,class,resources<br>这些jar都是要加载在内存里的啊；</li></ul><blockquote><p>10个就重复10遍 <code>9 * 10M</code>(?)内存的浪费</p></blockquote><p>当然在 内存也就那点钱,<strong>摩尔定律</strong> 完全可以解决这个问题,</p><p><strong><em><code>能用钱解决的问题更本就不是问题</code></em></strong></p><p>到此结束！！！！<br>谢谢</p><p>朴素的劳动人民的品格教育我们,贪污浪费都是犯罪.<br>同时也见到有朋友公司有把公共的一部分jar抽离放在容器里共享的先例。</p><h2 id="question"><a href="#question" class="headerlink" title="question"></a>question</h2><ul><li>写在前面的话： 首先共享的前提是：大家都在运行在同一个进程里??<br>一个tomcat 或其他web容器也是可以多实例运行.??</li></ul><ul><li>[x] 要共享的话 jar应该放在哪里？直接丢在jdk安装目录里的lib 行不行，为啥子( <code>不行！！</code>)</li><li>[ ] 哪些是可以抽离去共享，大家都用的就可以共享吗</li></ul><h2 id="Java-Class-Loader简介"><a href="#Java-Class-Loader简介" class="headerlink" title="Java Class Loader简介"></a>Java Class Loader简介</h2><hr><p><img src="http://img.my.csdn.net/uploads/201104/10/0_1302447836COCZ.gif" alt="此处输入图片的描述"></p><hr><p><code>Bootstrp Class Loader</code> 加载过的jar是：jre/lib,jre/classses<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span><br><span class="line">   * bootstrap 加载的核心内裤</span><br><span class="line">   */</span></span><br><span class="line">URL[] urls=sun.misc.Launcher.getBootstrapClassPath().getURLs();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; urls.length; i++) &#123;</span><br><span class="line">    System.out.println(urls[i].toExternalForm());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/resources.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/rt.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/sunrsasign.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/jsse.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/jce.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/charsets.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/lib/jfr.jar</span><br><span class="line">file:/Library/Java/JavaVirtualMachines/jdk1.7.0_79.jdk/Contents/Home/jre/classes</span><br></pre></td></tr></table></figure><p><code>ExtClassLoader :</code> 加载的是jre\lib\ext 目录或者,参数 java.ext.dirs指定的目录</p><p><code>AppClassLoader :</code> 加载 classpath 指定的目录 ,我们自己写的Java文件一般默认就是这货加载的,</p><p><code>XXXXClassLoader :</code>自己定义加载类的classloader——&gt;parent = AppCLassLoader</p><h3 id="类加载机制"><a href="#类加载机制" class="headerlink" title="类加载机制"></a>类加载机制</h3><blockquote><p>向上委托,全部丢给你老大,你老大再丢给他的老大,当老大搞定不了了，就交给他小弟喽。。。直到你的直接领导也搞不定 就交给你去搞<br>全盘负责, 一旦某个classLoader决定加载一个类的时候,这个类用过的对象的那些类也由这个ClassLoader负责了..你用过的对象,别人怎么用(™D,这个世界那么多别人用过的对象…)。。。你自己统统搞定吧</p></blockquote><hr><p><img src="http://p.blog.csdn.net/images/p_blog_csdn_net/lovingprince/EntryImages/20090702/%E5%B9%BB%E7%81%AF%E7%89%878.PNG" alt="此处输入图片的描述"></p><hr><p>ClassLoader.java<br></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@CallerSensitive</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> ClassLoader <span class="title">getParent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (parent == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        SecurityManager sm = System.getSecurityManager();</span><br><span class="line">        <span class="keyword">if</span> (sm != <span class="keyword">null</span>) &#123;</span><br><span class="line">            checkClassLoaderPermission(parent, Reflection.getCallerClass());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parent;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"> <span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="keyword">boolean</span> resolve)</span><br><span class="line">        <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">            <span class="comment">// First, check if the class has already been loaded</span></span><br><span class="line">            <span class="comment">// 检查是否被加载过</span></span><br><span class="line">            Class c = findLoadedClass(name);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">long</span> t0 = System.nanoTime();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (parent != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="comment">// go daddy 丢给你爸爸去加载,递归下去 找你爷爷,....</span></span><br><span class="line">                        c = parent.loadClass(name, <span class="keyword">false</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// ExtClassLoader的 </span></span><br><span class="line">                        c = findBootstrapClassOrNull(name);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                    <span class="comment">// ClassNotFoundException thrown if class not found</span></span><br><span class="line">                    <span class="comment">// from the non-null parent class loader</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// If still not found, then invoke findClass in order</span></span><br><span class="line">                    <span class="comment">// to find the class.</span></span><br><span class="line">                    <span class="keyword">long</span> t1 = System.nanoTime();</span><br><span class="line">                    c = findClass(name);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// this is the defining class loader; record the stats</span></span><br><span class="line">                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">                resolveClass(c);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> c;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p></p><p>随手写了一段验证下 自定义的ClassLoader;得到的 父ClassLoader是ExtClassLoader ….<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FileSystemClassLoader fileSystemClassLoader = new FileSystemClassLoader(&quot;/&quot;);</span><br><span class="line"></span><br><span class="line">System.out.println(&quot;classpath: &quot; + fileSystemClassLoader.getParent().toString());</span><br></pre></td></tr></table></figure><p></p><p>凭什么啊！ 从代码上也没看出指定父ClassLoader的地方,我艹<br>后留意到<br><code>@CallerSensitive</code><br>public final ClassLoader getParent()</p><p>这个鬼注解,<br>从Oracle官网找了一段话 依然没怎么看懂,,(有了解少少或看到相关人能看懂的说明,@我)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Guideline 9-9 / ACCESS-9: Safely invoke standard APIs that perform tasks using the immediate caller&apos;s class loader instance</span><br><span class="line">The following static methods perform tasks using the immediate caller&apos;s class loader:</span><br><span class="line"></span><br><span class="line">        java.lang.Class.forName</span><br><span class="line">        java.lang.Package.getPackage(s)</span><br><span class="line">        java.lang.Runtime.load</span><br><span class="line">        java.lang.Runtime.loadLibrary</span><br><span class="line">        java.lang.System.load</span><br><span class="line">        java.lang.System.loadLibrary</span><br><span class="line">        java.sql.DriverManager.deregisterDriver		</span><br><span class="line">        java.sql.DriverManager.getConnection</span><br><span class="line">        java.sql.DriverManager.getDriver(s)</span><br><span class="line">        java.util.logging.Logger.getAnonymousLogger</span><br><span class="line">        java.util.logging.Logger.getLogger</span><br><span class="line">        java.util.ResourceBundle.getBundle</span><br><span class="line"></span><br><span class="line">Methods such as these that vary their behavior according to the immediate caller&apos;s class are considered to be caller-sensitive, and should be annotated in code with the @CallerSensitive annotation [16].</span><br><span class="line"></span><br><span class="line">For example, System.loadLibrary(&quot;/com/foo/MyLib.so&quot;) uses the immediate caller&apos;s class loader to find and load the specified library. (Loading libraries enables a caller to make native method invocations.) Do not invoke this method on behalf of untrusted code, since untrusted code may not have the ability to load the same library using its own class loader instance. Do not invoke any of these methods using inputs provided by untrusted code, and do not propagate objects that are returned by these methods back to untrusted code.</span><br></pre></td></tr></table></figure><p>不纠结这个鬼了。</p><h3 id="Jetty-Web容器的-ClassLoader"><a href="#Jetty-Web容器的-ClassLoader" class="headerlink" title="Jetty Web容器的 ClassLoader :"></a>Jetty Web容器的 ClassLoader :</h3><p>每个web上下文（web应用和war文件）的普通配置是有自身的classloader，系统的classloader是它的父类。这是普通的java classloader的层次，但是servlet规范提出了负责的层次要求：</p><ol><li><p>在WEB-INF/lib和WEB-INF/classes中包含的类的加载优先级高于父classloader中的类。这和普通的java2的classloader加载动作相反。</p></li><li><p>像java.lang.String这样的系统类不会被WEB-INF/lib或者WEB-INF/classes中的类替代。不幸的是，servlet规范并没有清楚的规定哪些类是系统类，也没有清楚的指出javax类应该作为系统类</p></li><li><p>Server实现类应该对web应用和其他classloader不可见。不幸的是，servelt规范并没有规定什么是server class ，也没有清楚的指出像xerces parser 这样的common libraries应该作为实现类。</p></li></ol><p>具体的哪些jar 放在 jetty.home/XXX/lib 下 还是其他什么地方,看诸位的实验结果了…</p><p><code>(全是空口无凭)</code></p><hr><p><img src="http://7xogqz.com1.z0.glb.clouddn.com/qrcode_for_gh_ee75564456c8_430.jpg" alt="qrcode"></p><hr>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
















<!-- 搜索引擎优化(SEO) 添加百度主动推送代码，让搜索引擎最快发现文章 -->


  
    <article id="post-SOA的发展与毁灭" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/SOA的发展与毁灭/" class="article-date">
      <time datetime="2016-06-26T12:40:00.000Z" itemprop="datePublished">2016-06-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/SOA的发展与毁灭/">SOA的发展与毁灭</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="SOA的发展与毁灭"><a href="#SOA的发展与毁灭" class="headerlink" title="SOA的发展与毁灭"></a>SOA的发展与毁灭</h1><h2 id="SOA-发展之路"><a href="#SOA-发展之路" class="headerlink" title="SOA 发展之路"></a>SOA 发展之路</h2><ul><li>dubbo plugin<ul><li>(1) dubbo + thrift（可以参照dubbo源码里关于RMI的实现继续优化） 与现有的thrift服务兼容管理的解决代码（已经可以使用）</li><li>(2)dubbo container: 监视所有dubbo服务的启动与关闭，用极光的监控系统发送通知消息</li><li>(3)dubbo+python+thrift:(未完成版)</li></ul></li></ul><h2 id="SOA一年后出现的问题的解决方案"><a href="#SOA一年后出现的问题的解决方案" class="headerlink" title="SOA一年后出现的问题的解决方案"></a>SOA一年后出现的问题的解决方案</h2><p><a href="http://www.v2ex.com/t/243773#reply0" target="_blank" rel="external">http://www.v2ex.com/t/243773#reply0</a></p><h2 id="SOA升级与抛弃-3-10年内的解决方案与思路"><a href="#SOA升级与抛弃-3-10年内的解决方案与思路" class="headerlink" title="SOA升级与抛弃  3-10年内的解决方案与思路"></a>SOA升级与抛弃 3-10年内的解决方案与思路</h2><p><a href="https://www.zybuluo.com/tianzhidao28/note/382583" target="_blank" rel="external">https://www.zybuluo.com/tianzhidao28/note/382583</a></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/dubbo/">dubbo</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/">dubbo</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
















<!-- 搜索引擎优化(SEO) 添加百度主动推送代码，让搜索引擎最快发现文章 -->


  
    <article id="post-SOA今天" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/SOA今天/" class="article-date">
      <time datetime="2016-06-19T19:39:00.000Z" itemprop="datePublished">2016-06-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/SOA今天/">快速书写dubbo服务 与 API项目</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="快速书写dubbo服务-与-API项目"><a href="#快速书写dubbo服务-与-API项目" class="headerlink" title="快速书写dubbo服务 与 API项目"></a>快速书写dubbo服务 与 API项目</h1><h2 id="what"><a href="#what" class="headerlink" title="what"></a>what</h2><blockquote><p>这是 一个用来快速生成dubbo项目或者 使用dubbo来些 api的模版项目, 可以帮你节约<code>80%</code>的开发时间</p></blockquote><h2 id="why"><a href="#why" class="headerlink" title="why"></a>why</h2><ul><li>1个命令帮你在<code>20秒</code>构件一个完整的项目,再也不用花时间去搭建项目，找各种依赖,里面还帮你自动 加入了developer-commons包,dubbo2.8.4,zk的包, dubbo的本地配置 和 正式的配置</li><li>子模块清晰明了的分模块结构 和 demo,让你即使不会dubbo 也可以快速完成你的业务服务</li><li>完善的打包方式。 考虑到各种情况, 此生成项目可以打出各种包，<ul><li>最小的jar,</li><li>包含所有jar文件的可执行jar包,</li><li>将jar文件和配置文件分开的压缩包(<code>推荐方式</code>)</li><li>可以让第三种方式快速发布的最小压缩包包</li></ul></li><li>完善的运行发布安装脚本<ul><li>一键发布接口的脚本</li><li>修复了dubbo官方脚本里在我们服务器出现的问题的,启动,暂停,重启脚本</li><li>配合我们现在使用的supervisor的启动服务脚本</li><li>还有一个本地发布脚本（需要配置免密登录,改写）</li></ul></li></ul><ul><li>最重的一点:<blockquote><p>里面有我引以为傲的 API异常码的一种设计思路,将 异常与APICode结合的设计思路, 少了你一些在API设计过程中的 if else 和校验之类的<code>杂质</code>出现在你的项目里，强烈推荐使用,demo或者说是这个模版项目的原型在<a href="http://*********/portal/portal-services" title="portal-service" target="_blank" rel="external">portal-service</a> ,源码在git@ssh-<em>**</em>.com:portal/portal-services.git</p></blockquote></li></ul><h2 id="how"><a href="#how" class="headerlink" title="how"></a>how</h2><ul><li>在终端下执行</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mvn archetype:generate -DgroupId=cn.jpush -DartifactId=xx-service -Dpackage=你的包名  -DarchetypeVersion=1.0.0 -DarchetypeArtifactId=dubbox-service-archetype -DarchetypeGroupId=cn.jpush -DinteractiveMode=false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> mvn archetype:generate -DgroupId=cn.jpush -DartifactId=xx-service -Dpackage=cn.jpush.xx  -DarchetypeVersion=1.0.0 -DarchetypeArtifactId=dubbox-service-archetype -DarchetypeGroupId=cn.jpush -DinteractiveMode=false</span><br></pre></td></tr></table></figure><ul><li><p>在IDE里面生成项目</p><p>IDEA:<br><img src="http://7xogqz.com1.z0.glb.clouddn.com/QQ20160128-1.png" alt="1"></p></li></ul><h2 id="end"><a href="#end" class="headerlink" title="end"></a>end</h2><p><img src="http://7xogqz.com1.z0.glb.clouddn.com/xxservice.png" alt="2"></p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/dubbo/">dubbo</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/api/">api</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dubbo/">dubbo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/">java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/">rpc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/service/">service</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/soa/">soa</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>
















<!-- 搜索引擎优化(SEO) 添加百度主动推送代码，让搜索引擎最快发现文章 -->


  
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 rocyuan
            </div>
            <div class="footer-right">
                <a href="http://github.com/tianzhidao28/" target="_blank" title="rocyuan">github</a>  <a href="http://gdcainfo.miitbeian.gov.cn" target="_blank" title="神之梦">粤ICP备14066359号-1</a> admin by rocyuan <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本站到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-79859573-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>